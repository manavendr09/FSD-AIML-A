<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recipe Store</title>
</head>
<body>
    <h1>Recipe Collection</h1>
<table border="1" style="width: 100%;height: 100%;">
    <thead>
        <tr>
            <th>S.no</th>
            <th>Name</th>
            <th>Image</th>
            <th>Rating</th>
            <th>Price</th>
            <th>Action</th>
            <th>View Orders</th>
        </tr>
    </thead>
    <tbody id="table-body"></tbody>
</table>

<div>
    <h2>Cart Summary</h2>
    <div id="cart-items"></div>
    <p id="total-price">Total: ₹0.00</p>
</div>

<script>
    const cart = {};
    
    function addToCart(recipeId, recipeName, recipePrice) {
        if (!cart[recipeId]) {
            cart[recipeId] = {
                name: recipeName,
                price: recipePrice,
                quantity: 0
            };
        }
        cart[recipeId].quantity++;
        updateCartDisplay(recipeId);
        updateCartSummary();
    }
    
    function updateCartDisplay(recipeId) {
        const cartCountElement = document.getElementById(`cart-count-${recipeId}`);
        if (cartCountElement) {
            cartCountElement.textContent = cart[recipeId].quantity;
        }
    }
    
    function updateCartSummary() {
        const cartItemsElement = document.getElementById('cart-items');
        const totalPriceElement = document.getElementById('total-price');
        let cartHTML = '';
        let totalPrice = 0;
        
        for (const recipeId in cart) {
            if (cart[recipeId].quantity > 0) {
                const item = cart[recipeId];
                const itemTotal = item.price * item.quantity;
                totalPrice += itemTotal;
                
                cartHTML += `
                    <div>
                        ${item.name} - ₹${item.price.toFixed(2)} x ${item.quantity} = ₹${itemTotal.toFixed(2)}
                    </div>
                `;
            }
        }
        
        if (cartHTML === '') {
            cartHTML = '<p>Your cart is empty</p>';
        }
        
        cartItemsElement.innerHTML = cartHTML;
        totalPriceElement.textContent = `Total: ₹${totalPrice.toFixed(2)}`;
    }
    
    const url = "https://dummyjson.com/recipes";
    fetch(url)
        .then(response => {
            if (!response.ok) {
                throw new Error("Network response was not ok");
            }
            return response.json();
        })
        .then(data => {
            const tableBody = document.getElementById("table-body");
            data.recipes.forEach((recipe, index) => {
                const price = (Math.random() * 100 + 100).toFixed(2);
                
                const row = document.createElement("tr");
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td>${recipe.name}</td>
                    <td><img src="${recipe.image}" alt="${recipe.name}" width="100"></td>
                    <td>${recipe.rating}</td>
                    <td>₹${price}</td>
                    <td><button onclick="addToCart(${recipe.id}, '${recipe.name}', ${price})">Add to Cart</button></td>
                    <td><span id="cart-count-${recipe.id}">0</span></td>
                `;
                tableBody.appendChild(row);
                
                cart[recipe.id] = {
                    name: recipe.name,
                    price: parseFloat(price),
                    quantity: 0
                };
            });
        })
        .catch(error => {
            console.error("Error fetching recipes:", error);
            document.getElementById("table-body").innerHTML = `
                <tr>
                    <td colspan="7">
                        Failed to load recipes. Please try again later.
                    </td>
                </tr>
            `;
        });
</script>
</body>
</html>
